03_saptarum = {
    header = "lotr_generic_mission_mountain_headers"
    icon = "saptarum_1"

    repeatable = no
    chance = 1000

    potential = {
    	tag = SV2
        NOT = { has_variable = mission_cooldown_var }
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
        #hidden_effect = {
        #    reverse_add_opinion = { target = SV4 modifier = opinion_declared_war  }
        #}
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {
        capital_scope = {
            capital_formable_huge_effect = yes
        }
    }


######EMPIRE

    03_saptarum_task_1 = {
        icon = "task_diplomatic"
        duration = 120

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            war = no
            government = feudal_monarchy
            political_influence >= 100
            current_ruler = {
                popularity >= 70
            }
            stability >= 50
            custom_tooltip = {
                text = saptarum_stooltip_1
                job_holder:office_foreign_minister = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_royal_tutor = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_marshal = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_master_of_the_guard = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_high_priest_monarchy = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_philosopher = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_steward = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:office_physician = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:civic_tech = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:military_tech = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:oratory_tech = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
                job_holder:religious_tech = {
                    NOT = {
                        OR = {
                            has_same_family = char:91
                            has_same_family = char:92
                        }
                    }
                }
            }
        }
        on_completion = {
            custom_tooltip = saptarum_stooltip_2
            trigger_event = me_saptarum.1
        }
    }

    03_saptarum_task_2 = {
        icon = "task_conquest"
        requires = {03_saptarum_task_1}

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            has_law = work_for_the_best
            political_influence >= 20
            military_experience >= 20
        }
        on_completion = {
            add_political_influence = -20
            add_military_experience = -20
            add_country_modifier = {
                name = forrj_guard_mod
                duration = -1
            }
            custom_tooltip = saptarum_stooltip_3
            hidden_effect = {
            create_unit = {
                navy = no
                name = "Forrj Guard"
                location = capital_scope
                hidden_effect = {
                    add_subunit = heavy_infantry
                    add_subunit = heavy_infantry
                    add_subunit = heavy_infantry
                    add_subunit = heavy_infantry 
                    add_subunit = heavy_cavalry                                        
                    add_food = 150
                    add_morale = 3
                }
            }
        }
        trigger_event = me_saptarum.2
        }
    }

    03_saptarum_task_3 = {
        icon = "task_political"
        requires = {03_saptarum_task_1}
        duration = 30

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            political_influence >= 20
            treasury >= 50
            military_experience >= 10 
        }
        on_completion = {
            add_political_influence = -20
            add_treasury = -50
            add_military_experience = -10
            switch_government_type_event_clearup_effect = yes
            hidden_effect = {
                current_ruler = {
                    force_add_trait = ambitious
                }
            }
            add_country_modifier = {
                name = royal_army_mod
                duration = -1
            }
            change_government = despotic_monarchy
            add_stability = 10
            trigger_event = me_saptarum.3
        }
    }

    03_saptarum_task_4 = {
        icon = "task_expansion"
        requires = {03_saptarum_task_3}
        duration = 30

        highlight = {
            scope:province = {
                OR = {
                    owner = c:SV4
                }
            }
        }

        bypass = { 
            c:SV4 = { has_land = no }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns_or_subject_owns = 2651
            hidden:c:SV4 = {
                opinion = {
                    target = root
                    value >= 100
                }
            }
            political_influence >= 20
        }
        on_completion = {
            add_political_influence = -20
            p:2651 = {
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            C:SV4 = { every_owned_province = { set_owned_by = SV2 } }
            custom_tooltip = saptarum_stooltip_16
            hidden_effect = {
                area:morrigan_borderlands_2 = {
                    add_provincial_claim_effect = yes
                }
                area:morrigan_borderlands_3 = {
                    add_provincial_claim_effect = yes
                }
                area:morrigan_borderlands_4 = {
                    add_provincial_claim_effect = yes
                }
            }
            trigger_event = me_saptarum.4
        }
    }

    03_saptarum_task_5 = {
        icon = "task_battle"
        requires = {03_saptarum_task_4}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = morrigan_borderlands_2
                    is_in_area = morrigan_borderlands_3
                    is_in_area = morrigan_borderlands_4
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns_area = morrigan_borderlands_4
            owns_percent_of_area = {
                PROVINCE = "p:2686" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2469" 
                PERCENT = "0.75"
            }
            custom_tooltip = {
                text = saptarum_stooltip_4
                any_country_culture = {
                    is_culture = leslesi
                    has_pop_type_right = citizen
                }
            }
        }
        on_completion = {
            set_variable = unlock_borderlander_reward
            add_country_modifier = {
                name = leslesi_auxiliaries_mod
                duration = -1
            }
            p:2727 = {
                add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            p:2669 = {
            add_province_modifier = {
            name = recruitment_centers_mod
            duration = 3650
                }
                set_city_status = city
            }
            p:2249 = {
            add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            custom_tooltip = saptarum_stooltip_5
            hidden_effect ={
                p:2559 = {
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:2651 = {
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
            }
            custom_tooltip = saptarum_stooltip_6
            hidden_effect = {
                area:gaelica_area_1 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_2 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_3 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_4 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_5 = {
                    add_provincial_claim_effect = yes
                }
            }
            trigger_event = me_saptarum.5
        }
    }

    03_saptarum_task_6 = {
        icon = "task_calm"
        requires = {03_saptarum_task_5}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2187
                    province_id = 2581
                    province_id = 2790
                    province_id = 3252
                    province_id = 2878
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns = 2187
            owns = 2581
            owns = 2790
            owns = 3252
            owns = 2878
        }
            
        on_completion = {
            add_city_smoke_effect = yes
            add_city_fire_effect = yes
            add_treasury = 250
            hidden_effect = {
                p:2187 = {
                    add_city_smoke_effect = yes
                    add_city_fire_effect = yes
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 2
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 3
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                }
                p:2581 = {
                    add_city_smoke_effect = yes
                    add_city_fire_effect = yes
                    change_province_name = Gorhoffabi
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 2
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 3
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                }
                p:2790 = {
                    add_city_smoke_effect = yes
                    add_city_fire_effect = yes
                    change_province_name = Barrhoffabi
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 2
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 3
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                }
                p:3252 = {
                    add_city_smoke_effect = yes
                    add_city_fire_effect = yes
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 2
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 3
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                }
                p:2878 = {
                    add_city_smoke_effect = yes
                    add_city_fire_effect = yes
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 2
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                    ordered_pops_in_province = {
                        order_by = pop_hapiness
                        max = {
                            value = total_population
                            divide = 3
                        }
                        min = {
                            value = 0
                        }
                        kill_pop = yes
                    }
                }
            }
            add_country_modifier = {
                name = orkksigrramoggen_mod
                duration = 3650
            }
            add_innovation = 3
            trigger_event = me_saptarum.6
            hidden_effect = {
                c:ORC = { trigger_event = me_saptarum.7}
                c:BT6 = { trigger_event = me_saptarum.7}
                c:BT9 = { trigger_event = me_saptarum.7}
                c:BIG = { trigger_event = me_saptarum.7}
                c:BI3 = { trigger_event = me_saptarum.7}    
            }
        }
    }

    03_saptarum_task_7 = {
        icon = "task_economical"
        requires = {03_saptarum_task_5}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 3156
                    province_id = 3172
                    province_id = 3110
                    province_id = 2943
                    province_id = 3231
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns = 3156
            owns = 3172
            owns = 3110
            owns = 2943
            owns = 3231
        }
        on_completion = {
            p:3156 = {
            add_province_modifier = {
                name = subjugated_celticans_mod
                duration = 3650
                }
            }
            p:3172 = {
            add_province_modifier = {
                name = subjugated_celticans_mod
                duration = 3650
                }
            }
            p:3110 = {
            add_province_modifier = {
                name = subjugated_celticans_mod
                duration = 3650
                }
            }
            p:2943 = {
            add_province_modifier = {
                name = subjugated_celticans_mod
                duration = 3650
                }
            }
            p:3231 = {
            add_province_modifier = {
                name = subjugated_celticans_mod
                duration = 3650
                }
            }
            add_5_free_province_investments = yes
            trigger_event = me_saptarum.8
        }
    }

    03_saptarum_task_8 = {
        icon = "task_economical"
        requires = { 03_saptarum_task_6 03_saptarum_task_7}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2187
                    province_id = 2581
                    province_id = 2790
                    province_id = 3252
                    province_id = 2878
                    province_id = 3156
                    province_id = 3172
                    province_id = 3110
                    province_id = 2943
                    province_id = 3231
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            custom_tooltip = {
                text = saptarum_stooltip_7
                p:2187 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2581 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2790 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3252 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2878 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3156 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3172 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3110 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2943 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3231 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
            }
            num_of_ships >= 35
        }
        on_completion = {
            add_treasury = 1000
            add_political_influence = 50
            hidden_effect = {
                P:2878 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2581 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2790 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:3252 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2187 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:3156 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:3172 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:3110 = {
                    add_permanent_province_modifier = {
                    name = galmar_trade_port_mod
                    duration = -1
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2943 = {
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:3231 = {
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
            }
            add_5_free_province_investments = yes
            add_country_modifier = {
                name = orcish_sea_trade_mod
                duration = 10950
            }
            custom_tooltip = saptarum_stooltip_8
            custom_tooltip = saptarum_stooltip_17
            hidden_effect = {
                area:wegalia_minori_2  = {
                    add_provincial_claim_effect = yes
                }
                area:wegalia_minori_tofix  = {
                    add_provincial_claim_effect = yes
                }
            }
            trigger_event = me_saptarum.9
        }
    }

    03_saptarum_task_9 = {
        icon = "task_expansion"
        requires = {03_saptarum_task_8}

        highlight = {
            scope:province = {
                is_in_region = wegalia_north_region
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns_area = wegalia_minori_2
            owns_area = wegalia_minori_tofix 
        }
        on_completion = {
            add_treasury = 250
            add_aggressive_expansion = -15
            custom_tooltip = saptarum_stooltip_18
            hidden_effect = {
                area:wegalia_minori_2  = {
                    add_provincial_claim_effect = yes
                }
                area:wegalia_minori_tofix  = {
                    add_provincial_claim_effect = yes
                }
            }
            trigger_event = me_saptarum.10
            hidden_effect = {
                c:SOV = { trigger_event = me_saptarum.11 }
                c:EGA = { trigger_event = me_saptarum.11 }
                c:JRE = { trigger_event = me_saptarum.11 }
                c:EGY = { trigger_event = me_saptarum.11 }
                c:UPJ = { trigger_event = me_saptarum.11 }    
            }
        }
    }

    03_saptarum_task_10 = {
        icon = "task_political"
        requires = {03_saptarum_task_9}

        highlight = {
            scope:province = {
                OR = {
                    is_in_region = wegalia_major_region
                    is_in_region = wegalia_shout_region
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns_region = wegalia_major_region
            owns_region = wegalia_shout_region
        }
        on_completion = {
            add_treasury = 250
            add_political_influence = 50
            add_aggressive_expansion = -15
            trigger_event = me_saptarum.12
        }
    }

    03_saptarum_task_11 = {
        icon = "task_atlas"
        requires = {03_saptarum_task_10}
        duration = 60

        highlight = {
            scope:province = {
                OR = {
                province_id = 2347
                province_id = 2422
                province_id = 2561
                province_id = 2768
                province_id = 2796
                province_id = 2720
                province_id = 2774
                province_id = 3142
                province_id = 3382
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            owns = 2347
            owns = 2422
            owns = 2561
            owns = 2768
            owns = 2796
            owns = 2720
            owns = 2774
            owns = 3142
            owns = 3382
            political_influence >= 35
        }

        on_start = {
            trigger_event = me_saptarum.16
        }

        on_completion = {
            add_political_influence = -35
            custom_tooltip = saptarum_stooltip_9
            trigger_event = me_saptarum.13
        }
    }

    03_saptarum_task_12 = {
        icon = "task_heracles"
        requires = {03_saptarum_task_2 03_saptarum_task_11}
        duration = 70
        final = yes

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        bypass = {
            tag = FRJ
        }

        allow = {
            political_influence >= 35
            treasury >= 1000
            p:2559 = {
                has_building = fortress_building
                has_building = commerce_building
                has_building = academy_building
                has_building = court_building
                has_building = forum_building
            }
        }
        on_completion = {
            add_political_influence = -35
            add_treasury = -1000
            trigger_event = me_saptarum.19
        }
    }

    03_saptarum_task_13 = {
        icon = "task_economical"
        requires = {03_saptarum_task_11}
        duration = 360
        final = yes

        highlight = {
            scope:province = {
                OR = {
                province_id = 2347
                province_id = 2422
                province_id = 2561
                province_id = 2768
                province_id = 2796
                province_id = 2720
                province_id = 2774
                province_id = 3142
                province_id = 3382
                }
            }
        }

        prevented_by = { 03_saptarum_task_14 }

        allow = {
            custom_tooltip = {
            text = saptarum_stooltip_10
                p:2347 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:2422 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:2561 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:2768 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:2796 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:2720 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:2774 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:3142 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
                p:3382 = {
                    owner = ROOT
                    has_city_status = no
                    has_building = local_forum_building
                }
            }
            political_influence >= 50
            treasury >= 500
        }
        on_completion = {
            add_political_influence = -50
            add_treasury = -500
            custom_tooltip = saptarum_stooltip_11
            hidden_effect = {
                p:2347 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2422 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:2561 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2768 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:2796 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
                p:2720 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    add_permanent_province_modifier = {
                    name = sorrborr_mod
                    duration = -1
                    }
                    change_province_name = Nrkrstoffborr
                    set_city_status = city_metropolis
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:2774 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:3142 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:3382 = {
                    add_permanent_province_modifier = {
                    name = rebuilt_city_mod
                    duration = -1
                    }
                    set_city_status = city
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = galmar
                        religion = the_old_father_silver
                    }
                }
            }
            trigger_event = me_saptarum.20
        }
    }


######Republic

    03_saptarum_task_14 = {
        icon = "task_apollo"
        duration = 120

        highlight = {
			scope:province = {
				province_id = 2559
			}
		}

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            war = no
            government = merchant_republic
            hidden:p:2559 = {
                has_building = court_building
                has_building = military_building
            }
            political_influence >= 50
            military_experience >= 10
            ###ALL FAMILY HEADS AT 60 LOYALTY
            custom_tooltip = {
                text = family_heads_greater_60_loyalty_tt
                any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }
                any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }
                any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }  
            }
        }
        on_completion = {
            add_political_influence = -50
            add_military_experience = -10
            add_stability = 15
            change_law = republican_recruitment_1
            add_country_modifier = {
                name = citizen_soldiers_mod
                duration = -1
            }
            add_country_modifier = {
                name = thyrr_ubaturren_mod
                duration = -1
            }
            capital_scope = {
                create_state_pop = nobles
                create_state_pop = citizen
            }
            trigger_event = me_saptarum.21
        }
    }

    03_saptarum_task_15 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_14}
        duration = 30

        highlight = {
            scope:province = {
                OR = {
                    owner = c:SV4
                }
            }
		}

        bypass = {
            #IF ASPATA NO LONGER EXISTS BYPASS
            c:SV4 = { has_land = no }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            owns_or_subject_owns = 2651
            hidden:c:SV4 = {
                opinion = {
                    target = root
                    value >= 100
                }
            }
            political_influence >= 20
        }
        on_completion = {
            add_political_influence = -20
            capital_scope = {
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
            }
            C:SV4 = { every_owned_province = { set_owned_by = SV2 } }
            custom_tooltip = saptarum_stooltip_16
            hidden_effect = {
                area:morrigan_borderlands_2 = {
                    add_provincial_claim_effect = yes
                }
                area:morrigan_borderlands_3 = {
                    add_provincial_claim_effect = yes
                }
                area:morrigan_borderlands_4 = {
                    add_provincial_claim_effect = yes
                }
            }
            trigger_event = me_saptarum.22
        }
    }

        03_saptarum_task_16 = {
        icon = "task_expansion"
        requires = {03_saptarum_task_15}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = morrigan_borderlands_2
                    is_in_area = morrigan_borderlands_3
                    is_in_area = morrigan_borderlands_4
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            owns_area = morrigan_borderlands_4
            owns_percent_of_area = {
                PROVINCE = "p:2686" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2469" 
                PERCENT = "0.75"
            }
            custom_tooltip = {
                text = saptarum_stooltip_4
                any_country_culture = {
                    is_culture = leslesi
                    has_pop_type_right = citizen
                }
            }
        }
        on_completion = {
            set_variable = unlock_borderlander_reward
            add_country_modifier = {
                name = leslesi_auxiliaries_mod
                duration = -1
            }
            p:2727 = {
                add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            p:2669 = {
            add_province_modifier = {
            name = recruitment_centers_mod
            duration = 3650
                }
                set_city_status = city
            }
            p:2249 = {
            add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            custom_tooltip = saptarum_stooltip_5
            hidden_effect ={
                p:2559 = {
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
                p:2651 = {
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = freemen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                }
            }
            custom_tooltip = saptarum_stooltip_6
            hidden_effect = {
                area:gaelica_area_1 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_2 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_3 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_4 = {
                    add_provincial_claim_effect = yes
                }
                area:gaelica_area_5 = {
                    add_provincial_claim_effect = yes
                }
            }
            trigger_event = me_saptarum.23
        }
    }

    03_saptarum_task_17 = {
        icon = "task_conquest"
        requires = {03_saptarum_task_16}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2187
                    province_id = 2581
                    province_id = 2790
                    province_id = 3156
                    province_id = 3252
                    province_id = 3172
                    province_id = 3110
                    province_id = 2878
                    province_id = 2889
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            custom_tooltip = {
                text = saptarum_stooltip_7
                p:2187 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2581 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2790 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3156 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3252 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3172 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:3110 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2878 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
                p:2889 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = port_building
                    has_building = commerce_building
                }
            }
        }
        on_completion = {
            add_political_influence = 50
            add_treasury = 500
            add_5_free_province_investments = yes
            add_country_modifier = {
                name = orcish_sea_trade_mod
                duration = 7300
            }
            hidden_effect = {
                p:2187 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:2581 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                    change_province_name = Gorhoffabi
                }
                p:2790 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:3156 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:3252 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:3172 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:3110 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:2878 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
                p:2889 = {
                    add_permanent_province_modifier = {
                        name = galmar_trade_port_mod
                        duration = -1
                    }
                }
            }
            trigger_event = me_saptarum.24
        }
    }

    03_saptarum_task_18 = {
        icon = "task_battle"
        requires = {03_saptarum_task_16}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = morrigan_borderlands_1
                    is_in_area = gaelica_area_3
                    is_in_area = gaelica_area_4
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            owns_area = morrigan_borderlands_1
            owns_percent_of_area = {
                PROVINCE = "p:3207" 
                PERCENT = "0.5"
            }
            owns_percent_of_area = {
                PROVINCE = "p:3204" 
                PERCENT = "0.5"
            }
        }
        on_completion = {
            add_political_influence = 35
            add_military_experience = 20
            add_stability = 5
            trigger_event = me_saptarum.25
        }
    }

    03_saptarum_task_19 = {
        icon = "task_economical"
        requires = {03_saptarum_task_17}

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            num_of_ships >= 50
            treasury >= 100
        }

        on_completion = {
            add_treasury = -100
            add_innovation = 2
            add_country_modifier = {
                name = merchant_fleet_mod
                duration = 7300
            }
            trigger_event = me_saptarum.26
        }
    }

   03_saptarum_task_20 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_18}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2825
                    province_id = 3023
                    province_id = 3184
                    province_id = 2995
                    province_id = 3248
                    province_id = 3394
                    province_id = 2937
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            custom_tooltip = {
                text = saptarum_stooltip_12
                p:2825 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
                p:3023 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
                p:3184 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
                p:2995 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
                p:3248 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
                p:3394 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
                p:2937 = {
                    owner = ROOT
                    has_city_status = yes
                    has_building = academy_building
                    has_building = court_building
                    has_building = forum_building
                }
            }
        }
        on_completion = {
            add_treasury = 500
            add_5_free_province_investments = yes
            custom_tooltip = saptarum_stooltip_13
            hidden_effect = {
                p:2825 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
                p:3023 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
                p:3184 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
                p:2995 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
                p:3248 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
                p:3394 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
                p:2937 = {
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    random_pops_in_province = {
                        set_pop_culture = leslesi
                        set_pop_religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    define_pop = {
                        type = citizen
                        culture = leslesi
                        religion = the_old_father_silver
                    }
                    add_province_modifier = {
                    name = leslesi_colony_mod
                    duration = 7300
                    }
                }
            }
            trigger_event = me_saptarum.27
        }
    }

03_saptarum_task_21 = {
        icon = "task_calm"
        requires = {03_saptarum_task_19 03_saptarum_task_20}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                    province_id = 2651
                    province_id = 2636
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            p:2559 = {
                owner = ROOT
                has_city_status = yes
                has_building = foundry_building
            }
            p:2651 = {
                owner = ROOT
                has_city_status = yes
                has_building = foundry_building
            }
            p:2636 = {
                owner = ROOT
                has_city_status = yes
                has_building = foundry_building
            }
        }
        on_completion = {
            add_innovation = 3
            p:2559 = {
                add_permanent_province_modifier = {
                name = patronage_of_the_arts_mod
                duration = -1
            }
                hidden_effect = {
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                }
            }
            p:2651 = {
                add_permanent_province_modifier = {
                name = patronage_of_the_arts_mod
                duration = -1
                }
                hidden_effect = {
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                }
            }
            p:2636 = {
                add_permanent_province_modifier = {
                name = patronage_of_the_arts_mod
                duration = -1
                }
                change_province_name = Æmaffabi
                hidden_effect = {
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                    create_state_pop = freemen
                }
            }
            trigger_event = me_saptarum.28
        }
    }

    03_saptarum_task_22 = {
        icon = "task_religion"
        requires = {03_saptarum_task_21}
        duration = 365

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            treasury >= 500
            political_influence >= 50
            capital_scope = {
                is_importing_trade_good = wood
                is_importing_trade_good = cloth
                is_importing_trade_good = stone
                is_importing_trade_good = marble
            }
        }

        on_start = {
                trigger_event = me_saptarum.29
                show_as_tooltip = {
                    p:2559 = {
                        begin_great_work_construction = {
                            great_work = "the_great_hall"
                            locator = primary_great_work
                            is_ancient = yes                        
                        }
                    }
                    add_treasury = -500
                    add_political_influence = -50
                }
            }
        on_completion = {
            trigger_event = me_saptarum.30
            show_as_tooltip = {
                p:2559 = {
                    finish_great_work_construction = {
                        great_work = "the_great_hall"
                        locator = great_work
                    }
                }
                current_ruler = {
                    add_popularity = popularity_medium
                }
                add_stability = 5
            }
        }
    }

    03_saptarum_task_23 = {
        icon = "task_heracles"
        requires = {03_saptarum_task_22}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            p:2559 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                total_population >= 50
                free_building_slots = 0
            }
            treasury >= 100
        }
        on_completion = {
            add_treasury = -100
            add_innovation = 2
            p:2559 = {
            add_permanent_province_modifier = {
                name = sorrborr_mod
                duration = -1
            }
            add_permanent_province_modifier = {
                name = walls_of_god_mod
                duration = -1
            }
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                set_city_status = city_metropolis
                change_province_name = Saptaborr
            }
            trigger_event = me_saptarum.31
        }
    }

    03_saptarum_task_24 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_23}
        duration = 120

        bypass = {
            tag = SV9
        }

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            has_law = freemen_empowered
            p:2559 = {
                owner = ROOT
                has_building = forum_building
            }
            political_influence >= 50
        }

        on_completion = {
            custom_tooltip = saptarum_stooltip_14
            add_political_influence = -50
            trigger_event = me_saptarum.32
            }
        }

    03_saptarum_task_25 = {
        icon = "task_atlas"
        requires = {03_saptarum_task_23 03_saptarum_task_24}
        duration = 365
        final = yes

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            has_law = republican_total_acceptance
            custom_tooltip = {
                text = saptarum_stooltip_4
                any_country_culture = {
                    is_culture = leslesi
                    has_pop_type_right = citizen
                }
            }
            political_influence >= 100
        }
        on_completion = {
            add_political_influence = -100
            custom_tooltip = saptarum_stooltip_15
            trigger_event = me_saptarum.33
            hidden_effect = {
                trigger_event = {
                    id = saptarum.2
                    days = 360
                }
            }
        }
    }
}