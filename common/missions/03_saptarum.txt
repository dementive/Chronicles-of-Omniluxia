03_saptarum = {
    header = "lotr_umbar_mission_header"
    icon = "lotr_generic_ship_mission_icon"

    repeatable = no
    chance = 1000

    potential = {
    	tag = SV2
        NOT = { has_variable = mission_cooldown_var }
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
        hidden_effect = {
            reverse_add_opinion = { target = SV2 modifier = opinion_declared_war  }
        }
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {
        capital_scope = {
            capital_formable_huge_effect = yes
        }
    }


######EMPIRE

    03_saptarum_task_1 = {
        icon = "task_diplomatic"
        duration = 120

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        prevented_by = { 03_saptarum_task_13 }

        allow = {
            war = no
            government = feudal_monarchy
            political_influence >= 100
            ruler_popularity >= 70
            stability >= 50
            ###ALL FAMILY HEADS AT 60 LOYALTY
            any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }  
            any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                } 
           any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }
            }
            ############NO OFFICES BELONG TO KVARAN OR OTENSSONN

        on_completion = {
            add_political_influence = -100
            add_stability = -10
            add_country_modifier = {
                name = new_men_mod
                duration = 7300
            }
            create_character = {
                culture = silver_dwarven_3
                religion = the_old_father_silver
            }
            create_character = {
                culture = silver_dwarven_3
                religion = the_old_father_silver
            }
            create_character = {
                culture = silver_dwarven_3
                religion = the_old_father_silver
            }
            create_character = {
                culture = silver_dwarven_3
                religion = the_old_father_silver
            }
            create_character = {
                culture = silver_dwarven_3
                religion = the_old_father_silver
            }
            create_character = {
                culture = silver_dwarven_3
                religion = the_old_father_silver
            }
            #####EXPULSE ALL KVARAN AND OTENSONN FAMILY MEMBERS
            remove_country_modifier = plutocratic_society_mod
        }
    }

    03_saptarum_task_2 = {
        icon = "task_expansion"
        requires = {03_saptarum_task_1}

        allow = {
            ###has_law_enacted = work_for_the_best  ENACT ROYAL GUARDS LAW
            political_influence >= 20
            military_experience >= 20
        }
        on_completion = {
            add_political_influence = -20
            add_military_experience = -20
            add_country_modifier = {
                name = forrj_guard_mod
                duration = -1
            }
        }
    }

    03_saptarum_task_3 = {
        icon = "task_political"
        requires = {03_saptarum_task_1}
        duration = 30

        allow = {
            political_influence >= 20
            treasury >= 50
            military_experience >= 10 
        }
        on_completion = {
            add_political_influence = -20
            add_treasury = -50
            add_military_experience = -10
            add_stability = 20
            change_government = despotic_monarchy
            switch_government_type_event_clearup_effect = yes
            show_as_tooltip = {
                current_ruler = {
                force_add_trait = ambitious
                }
            }
            add_country_modifier = {
                name = royal_army_mod
                duration = -1
            }
        }
    }

    03_saptarum_task_4 = {
        icon = "task_conquest"
        requires = {03_saptarum_task_3}
        duration = 30

        highlight = {
            scope:province = {
                OR = {
                    owner = c:SV4
                }
            }
        }

        bypass = {
            #IF ASPATA NO LONGER EXISTS BYPASS
            owns = 2651
        }

        allow = {
            owns_or_subject_owns = 2651
            hidden:c:SV4 = {
                opinion = {
                    target = root
                    value >= 100
                }
            }
            political_influence >= 20
        }
        on_completion = {
            #ANNEX ALL ASPATA LANDS
            #on_diplo_annexation_event_effect = yes
            add_political_influence = -20
            capital_scope = {
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                }
            area:morrigan_borderlands_2 = {
                add_provincial_claim_effect = yes
            }
            area:morrigan_borderlands_3 = {
                add_provincial_claim_effect = yes
            }
            area:morrigan_borderlands_4 = {
                add_provincial_claim_effect = yes
            }
            }
    }

    03_saptarum_task_5 = {
        icon = "task_political"
        requires = {03_saptarum_task_4}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = morrigan_borderlands_2
                    is_in_area = morrigan_borderlands_3
                    is_in_area = morrigan_borderlands_4
                }
            }
        }

        allow = {
            owns_area = morrigan_borderlands_4
            owns_percent_of_area = {
                PROVINCE = "p:2686" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2469" 
                PERCENT = "0.75"
            }
            #poptype_rights = {
            #    {
            #        culture = borderlander_2
            #        type = citizen
           #     }
           #}
            treasury >= 100
        }
        on_completion = {
            add_treasury = -100
            #SAPTA GAINS BORDERLANDER TRADITIONS
            add_country_modifier = {
                name = leslesi_auxiliaries_mod
                duration = -1
            }
            p:2727 = {
                add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            p:2669 = {
            add_province_modifier = {
            name = recruitment_centers_mod
            duration = 3650
                }
                set_city_status = city
            }
            p:2727 = {
            add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            
            #ADD LESLESI CULTURE POPS TO SAPTABI AND ASPATABI

            area:gaelica_area_1 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_2 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_3 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_4 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_5 = {
                add_provincial_claim_effect = yes
            }
            }
    }

    03_saptarum_task_6 = {
        icon = "task_economical"
        requires = {03_saptarum_task_5}

        highlight = {
            scope:province = {
                OR = {
                province_id = 2187
                province_id = 2581
                province_id = 2790
                province_id = 3252
                province_id = 2878
                }
            }
        }

        allow = {
            owns = 2187
            owns = 2581
            owns = 2790
            owns = 3252
            owns = 2878
        }
        on_completion = {
            p:2581 = {
                change_province_name = Gørhöffabi
            }
            ###EXPLUSE 75% OF ORCISH POPS FROM THREE CITIES
            ###ORCISH EVENT
            add_country_modifier = {
                name = orkksigrramoggen_mod
                duration = 3650
            }
            add_innovation = 3
        }
    }

    03_saptarum_task_7 = {
        icon = "task_calm"
        requires = {03_saptarum_task_5}

        highlight = {
            scope:province = {
                OR = {
                is_in_area = morrigan_borderlands_1
                is_in_area = morrigan_borderlands_2
                is_in_area = morrigan_borderlands_3
                is_in_area = gaelica_area_1
                is_in_area = gaelica_area_2
                is_in_area = gaelica_area_3
                is_in_area = gaelica_area_5
                }
            }
        }

        allow = {
            num_of_ships >= 30
            owns_percent_of_area = {
                PROVINCE = "p:2388" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2686" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2890" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:3111" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:3221" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:3110" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2878" 
                PERCENT = "0.5"
            }
            p:2187 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_building
            }
            p:2581 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_building
            }
            p:2790 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_building
            }
            p:3252 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_building
            }
            p:2878 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_building
            }
            }
        on_completion = {
            add_treasury = 500
            add_political_influence = 50
            add_5_free_province_investments = yes
            add_country_modifier = {
                name = orcish_sea_trade_mod
                duration = 10950
            }
            P:2878 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2581 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2790 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:3252 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2187 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            area:wegalia_minori_2  = {
                add_provincial_claim_effect = yes
            }
            area:wegalia_minori_tofix  = {
                add_provincial_claim_effect = yes
            }
        }
    }

    03_saptarum_task_8 = {
        icon = "task_expansion"
        requires = {03_saptarum_task_6 03_saptarum_task_7}
        duration = 180

        highlight = {
            scope:province = {
                is_in_area = wegalia_minori_2
                is_in_area = wegalia_minori_tofix
            }
        }

        allow = {
            owns_area = wegalia_minori_2
            owns_area = wegalia_minori_tofix 
        }
        on_completion = {
            add_treasury = 200
            add_political_influence = 50
            ###ALL MAJOR POWERS GET BLOOD IN THE
            area:wegalia_minori_2  = {
                add_provincial_claim_effect = yes
            }
            area:wegalia_minori_tofix  = {
                add_provincial_claim_effect = yes
            }
            add_aggressive_expansion = -10
        }
    }

    03_saptarum_task_9 = {
        icon = "task_political"
        requires = {03_saptarum_task_8}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = wegalia_minori
                    is_in_area = wegalia_minori_1
                    is_in_area = wegalia_minori_3
                    is_in_area = wegalia_minori_4
                }
            }
        }


        allow = {
            owns_area = wegalia_minori
            owns_area = wegalia_minori_1
            owns_area = wegalia_minori_3
            owns_area = wegalia_minori_4
        }
        on_completion = {
            add_treasury = 200
            add_political_influence = 50
            add_aggressive_expansion = -10
        }
    }

    03_saptarum_task_10 = {
        icon = "task_atlas"
        requires = {03_saptarum_task_9}
        duration = 60

        highlight = {
            scope:province = {
                OR = {
                province_id = 2347
                province_id = 2422
                province_id = 2561
                province_id = 2768
                province_id = 2796
                province_id = 2720
                province_id = 2774
                province_id = 3142
                province_id = 3382
                }
            }
        }

        allow = {
            owns = 2347
            owns = 2422
            owns = 2561
            owns = 2768
            owns = 2796
            owns = 2720
            owns = 2774
            owns = 3142
            owns = 3382
            political_influence >= 20
        }
        on_completion = {
            add_political_influence = -20
            add_treasury = 2000
            p:2347 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:2422 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:2561 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:2768 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:2796 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:2720 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:2774 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:3142 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
            p:3382 = {
                add_province_modifier = {
                name = razed_city_mod
                duration = 180
                }
                set_city_status = settlement
                ##REMOVE 90% OF POP
            }
        }
    }

    03_saptarum_task_11 = {
        icon = "task_economical"
        requires = {03_saptarum_task_2 03_saptarum_task_10}
        duration = 60
        final = yes

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        bypass = {
            tag = FRJ
        }

        allow = {
            p:2559 = {
                has_building = fortress_building
                has building = commercial_building
                has building = academy_building
                has building = court_building
                has building = forum_building
                political_influence >= 30
                treasury >= 1000
            }
        }
        on_completion = {
            add_political_influence = -30
            add_treasury = -1000
            trigger_event = me_saptarum.1
        }
    }

    03_saptarum_task_12 = {
        icon = "task_economical"
        requires = {03_saptarum_task_10}
        duration = 120
        final = yes

        highlight = {
            scope:province = {
                OR = {
                province_id = 2347
                province_id = 2422
                province_id = 2561
                province_id = 2768
                province_id = 2796
                province_id = 2720
                province_id = 2774
                province_id = 3142
                province_id = 3382
                }
            }
        }

        allow = {
            p:2347 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:2422 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:2561 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:2768 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:2796 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:2720 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:2774 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:3142 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            p:3382 = {
                owner = ROOT
                has_city_status = no
                has_building = local_forum_building
            }
            political_influence >= 50
            treasury >= 500
        }
        on_completion = {
            add_political_influence = -50
            add_treasury = 500
            p:2347 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2422 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                ##ADD 5 LESLESI FREEMEN
            }
            p:2561 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2768 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                ##ADD 5 LESLESI FREEMEN
            }
            p:2796 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2720 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                add_permanent_province_modifier = {
                name = sorrborr_mod
                duration = -1
                }
                change_province_name = Nrkrstoffborr
                set_city_status = city_metropolis
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2774 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                ##ADD 5 LESLESI FREEMEN
            }
            p:3142 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                ##ADD 5 LESLESI FREEMEN
            }
            p:3382 = {
                add_permanent_province_modifier = {
                name = rebuilt_city_mod
                duration = -1
                }
                set_city_status = city
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
        }
    }


######Republic

    03_saptarum_task_13 = {
        icon = "task_apollo"
        duration = 120

        highlight = {
			scope:province = {
				province_id = 2559
			}
		}

        prevented_by = { 03_saptarum_task_1 }

        allow = {
            war = no
            government = merchant_republic
            p:2559 = {
                has_building = court_building
                has building = military_building
            }
            political_influence >= 50
            military_experience >= 10
            ###ALL FAMILY HEADS AT 60 LOYALTY
            any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }  
            any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                } 
           any_character = {
                    is_head_of_family = yes
                    loyalty >= 60
                }
        }
        on_completion = {
            add_political_influence = -50
            add_military_experience = -10
            add_stability = 15
            republic_military_recruitment_laws = republican_recruitment_1
            add_country_modifier = {
                name = citizen_soldiers_mod
                duration = -1
            }
            add_country_modifier = {
                name = thyrr_ubaturren_mod
                duration = -1
            }
            capital_scope = {
                create_state_pop = nobles
                create_state_pop = nobles
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
            }
            }
        }

    03_saptarum_task_14 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_13}
        duration = 30

        highlight = {
            scope:province = {
                OR = {
                    owner = c:SV4
                }
            }
		}

        bypass = {
            #IF ASPATA NO LONGER EXISTS BYPASS
            owns = 2651
        }

        allow = {
            owns_or_subject_owns = 2651
            hidden:c:SV4 = {
                opinion = {
                    target = root
                    value >= 100
                }
            }
            political_influence >= 20
        }
        on_completion = {
            #ANNEX ALL ASPATA LANDS
            #on_diplo_annexation_event_effect = yes
            add_political_influence = -20
            capital_scope = {
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                }
            area:morrigan_borderlands_2 = {
                add_provincial_claim_effect = yes
            }
            area:morrigan_borderlands_3 = {
                add_provincial_claim_effect = yes
            }
            area:morrigan_borderlands_4 = {
                add_provincial_claim_effect = yes
            }
            }
        }

        03_saptarum_task_15 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_14}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = morrigan_borderlands_2
                    is_in_area = morrigan_borderlands_3
                    is_in_area = morrigan_borderlands_4
                }
            }
        }

        allow = {
            owns_area = morrigan_borderlands_4
            owns_percent_of_area = {
                PROVINCE = "p:2686" 
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2469" 
                PERCENT = "0.75"
            }
            #LESLESI CULTURE MUST BE CITIZEN
            poptype_rights = {
                {
                    culture = borderlander_2
                    type = citizen
                }
            }
            treasury >= 100
        }
        on_completion = {
            add_treasury = -100
            #SAPTA GAINS BORDERLANDER TRADITIONS
            add_country_modifier = {
                name = leslesi_auxiliaries_mod
                duration = -1
            }
            p:2727 = {
                add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            p:2669 = {
                add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            p:2727 = {
                add_province_modifier = {
                name = recruitment_centers_mod
                duration = 3650
                }
                set_city_status = city
            }
            
            #ADD LESLESI CULTURE POPS TO SAPTABI AND ASPATABI

            area:gaelica_area_1 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_2 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_3 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_4 = {
                add_provincial_claim_effect = yes
            }
            area:gaelica_area_5 = {
                add_provincial_claim_effect = yes
            }
            }
        }

    03_saptarum_task_16 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_15}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2187
                    province_id = 2581
                    province_id = 2790
                    province_id = 3156
                    province_id = 3252
                    province_id = 3172
                    province_id = 3110
                    province_id = 2878
                    province_id = 2889
                }
            }
        }

        allow = {
            p:2187 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:2581 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_building
            }
            p:2790 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:3156 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:3252 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:3172 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:3110 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:2878 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            p:2889 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = port_building
                has building = commerce_buildin
            }
            }
        on_completion = {
            add_treasury = 500
            add_political_influence = 50
            add_5_free_province_investments = yes
            add_country_modifier = {
                name = orcish_sea_trade_mod
                duration = 7300
            }

            p:2187 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            p:2581 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
                change_province_name = Gørhöffabi
            }
            p:2790 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
                }
            }
            p:3156 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            p:3252 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            p:3172 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            p:3110 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            p:2878 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            p:2889 = {
                add_permanent_province_modifier = {
                name = galmar_trade_port_mod
                duration = -1
            }
            }
            }
        }

    03_saptarum_task_17 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_15}

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = morrigan_borderlands_1
                    is_in_area = gaelica_area_3
                    is_in_area = gaelica_area_4
                }
            }
        }

        allow = {
            owns_area = morrigan_borderlands_1
            owns_percent_of_area = {
                PROVINCE = "p:3207" 
                PERCENT = "0.5"
            }
            owns_percent_of_area = {
                PROVINCE = "p:3204" 
                PERCENT = "0.5"
            }
        }
        on_completion = {
            add_political_influence = 35
            add_treasury = 250
            add_stability = 5
            }
        }

    03_saptarum_task_18 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_16}

        allow = {
            num_of_ships >= 50
            treasury >= 100
        }
        on_completion = {
            add_treasury = -100
            add_innovation = 2
            add_country_modifier = {
                name = merchant_fleet_mod
                duration = 7300
            }
            }
        }

   03_saptarum_task_19 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_17}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2825
                    province_id = 3023
                    province_id = 3184
                    province_id = 2995
                    province_id = 3248
                    province_id = 3394
                    province_id = 2937
                }
            }
        }

        allow = {
            p:2825 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            p:3023 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            p:3184 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            p:2995 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            p:3248 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            p:3394 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            p:2937 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                has building = academy_building
                has building = court_building
                has building = forum_building
            }
            }
        on_completion = {
            add_treasury = 500
            add_5_free_province_investments = yes

            ###75% of city inhabitants become leslesi
            ###6 Leslesi citizen to each city


            p:2825 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
            }
            }
            p:3023 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
                }
            }
            p:3184 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
                }
            }
            p:2995 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
            }
            }
            p:3248 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
            }
            }
            p:3394 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
            }
            }
            p:2937 = {
                add_province_modifier = {
                name = leslesi_colony_mod
                duration = 7300
            }
            }
            }
        }

03_saptarum_task_20 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_18 03_saptarum_task_19}
        duration = 120

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }
        allow = {
            treasury >= 500
            political_influence >= 50
            capital_scope.state = {
                is_importing_trade_good = wood
                is_importing_trade_good = cloth
                is_importing_trade_good = stone
                is_importing_trade_good = marble
            }
        }

        on_start = {
               p:2559 = {
                    begin_great_work_construction = {
                        great_work = "sorrsalla"
                        locator = primary_great_work
                        is_ancient = yes                        
                    }
                }
                add_treasury = -500
                add_political_influence = -50
            }
        on_completion = {
            trigger_event = me_saptarum.2
            }
    }

    03_saptarum_task_21 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_20}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                    province_id = 2651
                    province_id = 2636
                }
            }
        }

        allow = {
            p:2559 = {
                owner = ROOT
                has_city_status = yes
                has_building = foundry_building
            }
            p:2651 = {
                owner = ROOT
                has_city_status = yes
                has_building = foundry_building
            }
            p:2636 = {
                owner = ROOT
                has_city_status = yes
                has_building = foundry_building
            }
            }
        on_completion = {
            add_treasury = 500
            add_innovation = 2
            p:2559 = {
                add_permanent_province_modifier = {
                name = patronage_of_the_arts_mod
                duration = -1
            }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2651 = {
                add_permanent_province_modifier = {
                name = patronage_of_the_arts_mod
                duration = -1
                }
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            p:2636 = {
                add_permanent_province_modifier = {
                name = patronage_of_the_arts_mod
                duration = -1
                }
                change_province_name = Æmaffabi
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
                create_state_pop = freemen
            }
            }
        }

    03_saptarum_task_22 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_21}

        highlight = {
            scope:province = {
                OR = {
                    province_id = 2559
                }
            }
        }

        allow = {
            owns = 2559

            p:2559 = {
                owner = ROOT
                has_city_status = yes
                has_building = fortress_building
                total_population >= 50
                free_building_slots = 0
            }
            treasury = 100
            }
        on_completion = {
            add_treasury = -100
            add_innovation = 2
            p:2559 = {
            add_permanent_province_modifier = {
                name = sorrborr_mod
                duration = -1
            }
            add_permanent_province_modifier = {
                name = walls_of_god_mod
                duration = -1
            }
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                create_state_pop = citizen
                set_city_status = city_metropolis
                change_province_name = Saptaborr
            }
            }
        }

    03_saptarum_task_23 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_21}
        duration = 120

        bypass = {
            tag = SV9
        }

        allow = {
            political_influence >= 50
            }
        on_completion = {
            add_political_influence = -50
            trigger_event = me_saptarum.3
            }
        }

    03_saptarum_task_24 = {
        icon = "task_diplomatic"
        requires = {03_saptarum_task_22 03_saptarum_task_23}
        duration = 365
        final = yes

        allow = {
            political_influence >= 100
            ###LESLESI CULTURE SET TO CITIZEN
            ###LESLESI CULTURE HAS RIGHT OF INTERMARRIAGE
            }
        on_completion = {
            add_political_influence = -100
            trigger_event = me_saptarum.4
            set_global_variable = itllmurren
            }
        }

}