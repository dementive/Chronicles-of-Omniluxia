namespace = jarenamfall

jarenamfall.1 = { ##JARENAM-ESQUALIAN INVASION
    type = country_event

    title = jarenamfall_1_title
    desc = jarenamfall_1_desc
    picture = city_country
    left_portrait = current_ruler
    right_portrait = c:EK1.current_ruler

    fire_only_once = yes

    option = {
        name = "jarenamfall_1.a"
        custom_tooltip = jarenamfall_1_tooltip.a
        hidden_effect = {
            add_legitimacy = -30
            add_stability = -25
            add_country_modifier = {
                name = jarenam_frustration_mod
                duration = 1825
            }
        }
        trigger_event = {
            id = jarenamfall.8
            days = { 90 180 }
        }
    }
    option = {
        name = "jarenamfall_1.b"
        custom_tooltip = jarenamfall_1_tooltip.b
        ai_chance = { factor = 10 }
        hidden_effect = {
	        add_legitimacy = 20
	        add_stability = 5
	        add_treasury = 200
	        c:JRE = {
	            declare_war_with_wargoal = {
	                war_goal = conquer_wargoal
	                province = 4016
	                target = EK1
	            }
	        }
	    }
	    c:PHK = {
		    trigger_event = {
	            id = jarenamfall.4
	            days = { 15 30 }
	        }
        }
        hidden_effect = { #GLOBAL ANNOUNCEMENT
            every_country = {
            	limit = {
            		NOT = {
            			OR = {
            				tag = JRE
            				country_culture_group = esquelian
            			}
            		}
            	}
                trigger_event = jarenamfall.3
            }
            #ESQUALIAN RESPONSES
            every_country = {
                limit = {
                	country_culture_group = esquelian
                }
                trigger_event = jarenamfall.2
            }
        }
    }
}

jarenamfall.2 = { ##ESQUELIANS DECIDE HOW TO REACT
    type = country_event

    title = jarenamfall_2_title
    desc = jarenamfall_2_desc
    picture = city_country
    left_portrait = current_ruler
    left_portrait = c:EK1.current_ruler
    right_portrait = c:JRE.current_ruler

    option = {
    	ai_chance = { factor = 1 }
        name = "jarenamfall_2.a"
        custom_tooltip = jarenamfall_2_tooltip.a
        c:JRE = {
            declare_war_with_wargoal = {
                war_goal = conquer_wargoal
                province = root.capital_scope
                target = ROOT
            }
        }
    }
    option = {
        name = "jarenamfall_2.b"
        custom_tooltip = jarenamfall_2_tooltip.b
        add_stability = 5
        add_tyranny = 5
    }
}

jarenamfall.3 = { ##WORLD DECLARATION JARENAM-ESQUALIAN INVASION
    type = country_event

    title = jarenamfall_3_title
    desc = jarenamfall_3_desc
    picture = city_country
    left_portrait = c:EK1.current_ruler
    right_portrait = c:JRE.current_ruler

    option = {
        name = "jarenamfall_3.a"
        custom_tooltip = jarenamfall_3_tooltip
    }
}

jarenamfall.4 = { ##PHANICIAN OPPORTUNISTS
    type = country_event

    title = jarenamfall_4_title
    desc = jarenamfall_4_desc
    picture = city_country
    left_portrait = current_ruler
    right_portrait = c:JRE.current_ruler

    fire_only_once = yes

    option = {
        name = "jarenamfall_4.a"
        custom_tooltip = jarenamfall_4_tooltip.a
        hidden_effect = {
	        c:PHK = {
	            declare_war_with_wargoal = {
	                war_goal = conquer_wargoal
	                province = p:3408
	                target = c:JRE
	            }
	        }
            c:JRE = {
                trigger_event = jarenamfall.5
            }
            c:EGY = {
			    trigger_event = {
		            id = jarenamfall.6
		            days = { 15 30 }
		        }
        	}
        }
    }
    option = {
        name = "jarenamfall_4.b"
        custom_tooltip = jarenamfall_4_tooltip.b
        add_stability = 10
        add_tyranny = 5
        c:EGY = {
			trigger_event = {
		        id = jarenamfall.6
		        days = { 15 30 }
		    }
        }
    }
}

jarenamfall.5 = { ##PHANICIAN OPPORTUNISTS ATTACK
    type = country_event

    title = jarenamfall_5_title
    desc = jarenamfall_5_desc
    picture = city_country
    left_portrait = c:JRE.current_ruler
    right_portrait = c:PHK.current_ruler

    option = {
        name = "jarenamfall_5.a"
        custom_tooltip = jarenamfall_5_tooltip
    }
}

jarenamfall.6 = { ##BAETEP OPPORTUNISTS
    type = country_event

    title = jarenamfall_6_title
    desc = jarenamfall_6_desc
    picture = city_country
    left_portrait = current_ruler
    right_portrait = c:JRE.current_ruler

    fire_only_once = yes

    option = {
        name = "jarenamfall_6.a"
        custom_tooltip = jarenamfall_6_tooltip.a
        hidden_effect = { 
	        c:EGY = {
	            declare_war_with_wargoal = {
	                war_goal = conquer_wargoal
	                province = p:3299
	                target = c:JRE
	            }
	        }
            c:JRE = {
            	trigger_event = jarenamfall.7
        	}
	        if = {
		        limit = {
		        	NOT = {
		        		has_global_variable = jarenam_fall_end
		        	}
		        }
		        c:JRE = {
					trigger_event = {
				        id = jarenamfall.8
				        days = { 10 12 }
				    }
			    }
			}
        }
    }
    option = {
        name = "jarenamfall_6.b"
        custom_tooltip = jarenamfall_6_tooltip.b
        add_stability = 10
        add_tyranny = 5
        if = {
	        limit = {
	        	NOT = {
	        		has_global_variable = jarenam_fall_end
	        	}
	        }
	        c:JRE = {
				trigger_event = {
			        id = jarenamfall.8
			        days = { 180 220 }
			    }
		    }
		}
    }
}

jarenamfall.7 = { ##BAETEP OPPORTUNISTS ATTACK
    type = country_event

    title = jarenamfall_4_title
    desc = jarenamfall_4_desc
    picture = city_country
    left_portrait = c:JRE.current_ruler
    right_portrait = c:EGY.current_ruler

    option = {
        name = "jarenamfall_7.a"
        custom_tooltip = jarenamfall_7_tooltip
    }
}

jarenamfall.8 = { ##BHAXIAN ZAIN & HELL REVOLT
    type = country_event

    title = jarenamfall_8_title
    desc = jarenamfall_8_desc
    picture = city_country
    left_portrait = current_ruler

    fire_only_once = yes

    goto_location = p:3764
    goto_location = p:4696

    immediate = {
		hidden_effect = {
		    create_character = {
		        first_name = "Supo"
		       	age = 25
		        culture = bhaxian
		        religion = helluvian
		        female = no
		        good_popularity_trait_effect = yes
		        save_scope_as = bhaxian_helluvian_king
		    }
			p:3764 = {
				create_country = {
	                set_country_religion = helluvian
	                if = {
						limit = {
							NOT = {
								primary_culture = bhaxian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = bhaxian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
	                change_country_name = "Holy Bhaxian Kingdom"
	                change_country_color = "holy_bhaxian"
	                change_government = theocratic_monarchy
	                change_country_adjective = "Bhaxian"
	                change_country_flag = IP3_FLAG
	                save_scope_as = helluvian_bhaxia
				}
			}
			scope:bhaxian_helluvian_king = {
				remove_all_positions = yes
				move_country = scope:helluvian_bhaxia
				set_home_country = scope:helluvian_bhaxia
				remove_character_modifier = foreign_citizen
			}
			p:3764.area = {
				every_area_province = {
					limit = {
						NOT = { owner = scope:helluvian_bhaxia }
						owner = c:JRE
					}
					set_owned_by = scope:helluvian_bhaxia
				}
			}
			p:3670.area = {
				every_area_province = {
					limit = {
						NOT = { owner = scope:helluvian_bhaxia }
						owner = c:JRE
					}
					set_owned_by = scope:helluvian_bhaxia
				}
			}
			scope:helluvian_bhaxia = {
				add_treasury = 1000
				add_manpower = 20
				set_as_ruler = scope:bhaxian_helluvian_king
				if = {
					limit = {
						NOR = {
							has_law = republican_recruitment_2 # legions capital
							has_law = republican_recruitment_4 # legions enabled
						}
					}
					change_law = republican_recruitment_2 # capital
				}
			}
			p:3764 = { # capital fort
				state = { set_state_capital = p:3764 }
				if = {
					limit = { can_build_building = fortress_building }
					add_building_level = fortress_building
				}
			}
		    create_character = {
		        first_name = "Ok-Unse"
		       	age = 21
		        culture = bhaxian
		        religion = zainuddian
		        female = no
		        good_popularity_trait_effect = yes
		        save_scope_as = bhaxian_zainuddian_king
			}
			p:4696 = {
				create_country = {
		            set_country_religion = zainuddian
		            if = {
						limit = {
							NOT = {
								primary_culture = bhaxian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = bhaxian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
		            change_country_name = "Bhaxian Kephalit"
		            change_country_color = "bhaxian_jihad"
		            change_government = kephalite
		            change_country_adjective = "Bhaxian"
		            change_country_flag = ZT3_FLAG
		            save_scope_as = zainuddian_bhaxia
				}
			}
			scope:bhaxian_zainuddian_king = {
				remove_all_positions = yes
				move_country = scope:zainuddian_bhaxia
				set_home_country = scope:zainuddian_bhaxia
				remove_character_modifier = foreign_citizen
			}
			p:4696 = {
				limit = {
					NOT = { owner =scope:zainuddian_bhaxia }
				}
				set_owned_by = scope:zainuddian_bhaxia
			}
			p:4630 = {
				limit = {
					NOT = { owner =scope:zainuddian_bhaxia }
				}
				set_owned_by = scope:zainuddian_bhaxia
			}
			p:4540 = {
				limit = {
					NOT = { owner =scope:zainuddian_bhaxia }
				}
				set_owned_by = scope:zainuddian_bhaxia
			}
			p:4708 = {
				limit = {
					NOT = { owner =scope:zainuddian_bhaxia }
				}
				set_owned_by = scope:zainuddian_bhaxia
			}
			p:4617 = {
				limit = {
					NOT = { owner =scope:zainuddian_bhaxia }
				}
				set_owned_by = scope:zainuddian_bhaxia
			}
			scope:zainuddian_bhaxia = {
				add_treasury = 1000
				add_manpower = 20
				set_as_ruler = scope:bhaxian_zainuddian_king
				if = {
					limit = {
						NOR = {
							has_law = republican_recruitment_2 # legions capital
							has_law = republican_recruitment_4 # legions enabled
						}
					}
					change_law = republican_recruitment_2 # capital
				}
			}
			p:4696 = { # capital fort
				state = { set_state_capital = p:4696 }
				if = {
					limit = { can_build_building = fortress_building }
					add_building_level = fortress_building
				}
			}
		}
    }

    option = {
        name = "jarenamfall_8.a"
        custom_tooltip = jarenamfall_8_tooltip
        scope:zainuddian_bhaxia = {
			declare_war_with_wargoal = {
				war_goal = conquer_wargoal
				province = 4572
				target = JRE
			}
		}
		scope:helluvian_bhaxia = {
			declare_war_with_wargoal = {
				war_goal = conquer_wargoal
				province = 3851
				target = JRE
			}
		}
		if = {
	        limit = {
	        	NOT = {
	        		has_global_variable = jarenam_fall_end
	        	}
	        }
	        c:JRE = {
				trigger_event = {
			        id = jarenamfall.9
			        days = { 90 180 }
			    }
		    }
		}
    }
}

jarenamfall.9 = { ##ETERADICAN REVOLT
    type = country_event

    title = jarenamfall_9_title
    desc = jarenamfall_9_desc
    picture = city_country
    left_portrait = current_ruler

    fire_only_once = yes

    goto_location = p:4479

    immediate = {
		hidden_effect = {
		    create_character = {
		        first_name = "Bosilkas"
		       	age = 25
		        culture = kenbanntian
		        religion = zainuddian
		        female = no
		        good_popularity_trait_effect = yes
		        save_scope_as = eteradican_rebel
		    }
			p:4479 = {
				create_country = {
	                set_country_religion = zainuddian
	                if = {
						limit = {
							NOT = {
								primary_culture = kenbanntian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = kenbanntian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
	                change_country_name = "Gangankatdakap"
	                change_country_color = "eteradican_green"
	                change_government = tribal_kingdom
	                change_country_adjective = "Eteradican"
	                change_country_flag = EQ3_FLAG
	                save_scope_as = revolt_eteradica
				}
			}
			scope:eteradican_rebel = {
				remove_all_positions = yes
				move_country = scope:revolt_eteradica
				set_home_country = scope:revolt_eteradica
				remove_character_modifier = foreign_citizen
			}
			p:4445 = {
				set_owned_by = scope:revolt_eteradica
			}
			p:4573 = {
				set_owned_by = scope:revolt_eteradica
			}
			scope:revolt_eteradica = {
				add_treasury = 1000
				add_manpower = 20
				set_as_ruler = scope:eteradican_rebel
				if = {
					limit = {
						NOR = {
							has_law = republican_recruitment_2 # legions capital
							has_law = republican_recruitment_4 # legions enabled
						}
					}
					change_law = republican_recruitment_2 # capital
				}
			}
			p:4479 = { # capital fort
				state = { set_state_capital = p:4479 }
				if = {
					limit = { can_build_building = fortress_building }
					add_building_level = fortress_building
				}
			}
		}
    }

    option = {
        name = "jarenamfall_9.a"
        custom_tooltip = jarenamfall_9_tooltip
        scope:revolt_eteradica = {
			declare_war_with_wargoal = {
				war_goal = conquer_wargoal
				province = 3851
				target = JRE
			}
		}
		if = {
	        limit = {
	        	NOT = {
	        		has_global_variable = jarenam_fall_end
	        	}
	        }
	        c:JRE = {
				trigger_event = {
			        id = jarenamfall.10
			        days = { 90 180 }
			    }
		    }
		}
    }
}

jarenamfall.10 = { ##YEDIDYAHAN REVOLT
    type = country_event

    title = jarenamfall_10_title
    desc = jarenamfall_10_desc
    picture = city_country
    left_portrait = current_ruler

    fire_only_once = yes

    goto_location = p:4256

    immediate = {
		hidden_effect = {
		    create_character = {
		        first_name = "Sfisrael"
		       	age = 35
		        culture = bhaxian
		        religion = yedidyhan
		        female = no
		        good_popularity_trait_effect = yes
		        save_scope_as = yedidyhan_rebel
		        add_trait = vampire_trait
		    }
			p:4256 = {
				create_country = {
	                set_country_religion = yedidyhan
	                if = {
						limit = {
							NOT = {
								primary_culture = bhaxian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = bhaxian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
	                change_country_name = "Coven of Yedidyha"
	                change_country_color = "yedidyah_blue"
	                change_government = theocratic_monarchy
	                change_country_adjective = "Yedidyhan"
	                change_country_flag = DKK_FLAG
	                save_scope_as = revolt_yedidyhan
				}
			}
			scope:yedidyhan_rebel = {
				remove_all_positions = yes
				move_country = scope:revolt_yedidyhan
				set_home_country = scope:revolt_yedidyhan
				remove_character_modifier = foreign_citizen
			}
			scope:revolt_yedidyhan = {
				add_treasury = 1000
				add_manpower = 20
				set_as_ruler = scope:yedidyhan_rebel
				if = {
					limit = {
						NOR = {
							has_law = republican_recruitment_2 # legions capital
							has_law = republican_recruitment_4 # legions enabled
						}
					}
					change_law = republican_recruitment_2 # capital
				}
			}
			p:4256 = { # capital fort
				state = { set_state_capital = p:4256 }
				if = {
					limit = { can_build_building = fortress_building }
					add_building_level = fortress_building
				}
			}
		}
    }

    option = {
        name = "jarenamfall_10.a"
        custom_tooltip = jarenamfall_10_tooltip
        scope:revolt_yedidyhan = {
			declare_war_with_wargoal = {
				war_goal = conquer_wargoal
				province = 4142
				target = JRE
			}
		}
		if = {
	        limit = {
	        	NOT = {
	        		has_global_variable = jarenam_fall_end
	        	}
	        }
	        c:JRE = {
				trigger_event = {
			        id = jarenamfall.12
			        days = { 180 220 }
			    }
		    }
		}
    }
}

jarenamfall.11 = { ##CONQUERED ESQUALIA (GOOD ENDING)
    type = country_event

    title = jarenamfall_11_title
    desc = jarenamfall_11_desc
    picture = city_country
    left_portrait = current_ruler

    fire_only_once = yes

    immediate = {
    	set_global_variable = {
    		name = jarenam_fall_end
    	}
    }

    option = {
        name = "jarenamfall_4.a"
        custom_tooltip = jarenamfall_3_tooltip
        add_legitimacy = 50
        add_stability = 40
        add_political_influence = -20
        add_country_modifier = {
            name = reinvigorated_jarenam_mod
            duration = 1825
        }
        current_ruler = { add_trait = founder }
    }
}

jarenamfall.12 = { ##JARENAM CIVIL WAR
    type = country_event

    title = jarenamfall_12_title
    desc = jarenamfall_12_desc
    picture = city_country
    left_portrait = current_ruler
    right_portrait = char:117

    fire_only_once = yes

    immediate = {
        char:117 = {
            save_scope_as = rebel_scum
        }
    }

    option = {
        name = "jarenamfall_12.a"
        custom_tooltip = jarenamfall_12_tooltip
        add_legitimacy = -20
        add_stability = -10
		start_civil_war = scope:rebel_scum
        hidden_effect = { 
            scope:rebel_scum.employer = {
                change_country_name = "Great Salahad Ulus"
                change_country_adjective = "Jarenamite"
                change_country_color = forrj_red
                change_country_flag = "SOV2_FLAG"
                change_government = great_ulus
                save_scope_as = jarenam_revolt_country
            }
        }
		every_country = {
            limit = {
            	NOT = {
            		tag = JRE
            	}
            }
            trigger_event = jarenamfall.13
        }
        c:JRE = {
			trigger_event = {
			    id = jarenamfall.14
			    days = { 180 220 }
			}
		}
    }
}

jarenamfall.13 = { ##JARENAM CIVIL WAR ANNOUNCEMENT
    type = country_event

    title = jarenamfall_13_title
    desc = jarenamfall_13_desc
    picture = city_country
    left_portrait = current_ruler
    right_portrait = char:117
    right_portrait = char:29

    fire_only_once = yes

    option = {
        name = "jarenamfall_13.a"
        custom_tooltip = jarenamfall_13_tooltip
        c:SOV = { trigger_event = jarenamfall.14 }
    }
}

jarenamfall.14 = {
    type = country_event

    title = jarenamfall_14_title
    desc = jarenamfall_14_desc
    picture = war_council
    left_portrait = current_ruler
    right_portrait = c:JRE.current_ruler
    right_portrait = scope:jarenam_magistrate_1

    fire_only_once = yes

    immediate = {
        hidden_effect = {
            create_character = {
                age = 26
                female = no
                culture = sovenerian
                religion = dragkhan_pantheon
                add_trait = vengeful
                save_scope_as = jarenam_magistrate_1
            }
        }
    }

    option = {
        name = "me_azar_38.a"
        custom_tooltip = me_azar_38_tooltip_2
        hidden_effect = {
            p:5017 = {
                create_country = {
                    name = {
                        name = JARENAM_FEUDATORY_NAME
                        adjective = JARENAM_FEUDATORY_NAME_ADJECTIVE
                    }
                    change_country_color = olympian_white
                    if = {
						limit = {
							NOT = {
								primary_culture = jarenam
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = jarenam
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}	
                    change_country_tag = JQF
                    change_country_flag = "SOV2_FLAG" 
                    set_as_ruler = scope:jarenam_magistrate_1
                    set_country_religion = dragkhan_pantheon
                    change_government = despotic_monarchy
                    set_country_heritage = jarenam_refugee_heritage
                    save_scope_as = jarenam_qhaganate_country_scope
                }
                define_pop = {
                    type = nobles
                    culture = jarenam
                    religion = dragkhan_pantheon
                }
                define_pop = {
                    type = freemen
                    culture = jarenam
                    religion = dragkhan_pantheon
                }
                define_pop = {
                    type = serfs
                    culture = jarenam
                    religion = dragkhan_pantheon
                }
            }
            make_subject = {
                target = SOV
                type = feudatory
            }
            reverse_add_opinion = {
                modifier = opinion_friendly_neighbor
                target = scope:jarenam_qhaganate_country_scope
            }
        }
        c:SOV = { trigger_event = jarenamfall.15 }
    }
    option = {
        name = "me_azar_38.b"
        capital_scope = {
            define_pop = {
                type = nobles
                culture = jarenam
                religion = dragkhan_pantheon
            }
            define_pop = {
                type = nobles
                culture = jarenam
                religion = dragkhan_pantheon
            }
            define_pop = {
                type = citizen
                culture = jarenam
                religion = dragkhan_pantheon
            }
            define_pop = {
                type = citizen
                culture = jarenam
                religion = dragkhan_pantheon
            }
        }
    }
    option = {
        name = "me_azar_38.c"
        highlight = yes
        current_ruler = {
            force_add_trait = cruel
        }
        scope:jarenam_magistrate_1 = {
			death = { 
				death_reason = death_execution
				killer = root.current_ruler
			}
		}
        add_treasury = {
            add = root.has_monthly_income
            multiply = 36
        }
    }
}

jarenamfall.15 = {
    type = country_event

    title = jarenamfall_15_title
    desc = jarenamfall_15_desc
    picture = war_council
    left_portrait = current_ruler
    right_portrait = scope:jarenam_magistrate_1

    fire_only_once = yes

    option = {
        name = "me_azar_39.a"
        p:5017  = {
	        define_pop = {
	            type = freemen
	            culture = jarenam
	            religion = dragkhan_pantheon
	        }
	        define_pop = {
	            type = freemen
	            culture = jarenam
	            religion = dragkhan_pantheon
	        }
	    	define_pop = {
	            type = serfs
	            culture = jarenam
	            religion = dragkhan_pantheon
	        }
	    	define_pop = {
	            type = serfs
	            culture = jarenam
	            religion = dragkhan_pantheon
	        }
        }    
    }
    option = {
        name = "me_azar_39.b"
        highlight = yes
        custom_tooltip = me_azar_39_tooltip_2
        hidden_effect = {
            set_player_country = scope:jarenam_qhaganate_country_scope
        }
    }
}




