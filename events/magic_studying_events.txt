namespace = me_magic_studying

# PHASE ONE

# BASIC

# Initial Learning Event to Give Mage Trait
me_magic_studying.1 = {
    type = country_event

    title = me_magic_studying.1_title
    desc = me_magic_studying.1_desc
    picture = ascetic
    left_portrait = current_ruler

    fire_only_once = yes

    trigger = {
        AND = {
            NOT = {
                has_variable = first_time_mage_var
            }
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_one_var
        }
    }

    option = {
        name = "me_magic_studying.1.a"
        set_variable = first_time_mage_var
        add_political_influence = 15
    }
}

# Overworking
me_magic_studying.2 = {
    type = country_event

    title = me_magic_studying.2_title
    desc = me_magic_studying.2_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_one_var
        }
    }

    option = {
        name = "me_magic_studying.2.a"
        add_political_influence = -15
    }
}

# Shortcuts
me_magic_studying.3 = {
    type = country_event

    title = me_magic_studying.3_title
    desc = me_magic_studying.3_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_one_var
        }
    }

    option = {
        name = "me_magic_studying.3.a"
        set_variable = first_time_mage_var
        add_political_influence = -8
        add_stability = -3
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_one_var
    }

    option = {
        name = "me_magic_studying.3.b"
        add_stability = 5
        current_ruler = {
            add_popularity = popularity_medium
        }
    }
}

# Steady Advance
me_magic_studying.4 = {
    type = country_event

    title = me_magic_studying.4_title
    desc = me_magic_studying.4_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_one_var
        }
    }

    option = {
        name = "me_magic_studying.4.a"
        add_political_influence = 5
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_one_var
    }
}

# CLASS

# Diviner Accident T2
me_magic_studying.5 = {
    type = country_event

    title = me_magic_studying.5_title
    desc = me_magic_studying.5_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_one_var
            has_variable = omni_studying_diviner_var
            has_variable = diviner_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.5.a"
        capital_scope = {
            add_city_smoke_effect = yes
            add_city_fire_effect = yes
            ordered_pops_in_province = {
                order_by = pop_hapiness
                max = {
                    value = total_population
                    divide = 8
                }
                min = {
                    value = 0
                }
                kill_pop = yes
            }
        }
        add_treasury = -50
    }
}

# Necromancer Disgusted T1
me_magic_studying.6 = {
    type = country_event

    title = me_magic_studying.6_title
    desc = me_magic_studying.6_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_one_var
            has_variable = omni_studying_necromancer_var
            NOT = {
                has_variable = necromancer_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.6.a"
        custom_tooltip = me_magic_studying_1_tooltip
        current_ruler = {
            add_popularity = popularity_medium
        }
        add_stability = 12
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_phase_one_var
        remove_variable = omni_studying_necromancer_var
    }

    option = {
        name = "me_magic_studying.6.b"
        current_ruler = {
            force_add_trait = cruel
            add_legitimacy = -15
        }
        add_stability = -8
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_one_var
    }
}


# PHASE TWO

# BASIC

# Getting the Hang of Studies
me_magic_studying.7 = {
    type = country_event

    title = me_magic_studying.7_title
    desc = me_magic_studying.7_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
        }
    }

    option = {
        name = "me_magic_studying.7.a"
        add_political_influence = 15
        set_variable = omni_studying_phase_three_var
        remove_variable = omni_studying_phase_two_var
    }
}

# Bankrupting Self
me_magic_studying.7 = {
    type = country_event

    title = me_magic_studying.7_title
    desc = me_magic_studying.7_desc
    picture = ascetic
    left_portrait = current_ruler


    immediate = {
        add_treasury = -150
    }

    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
        }
    }

    option = {
        name = "me_magic_studying.7.a"
        add_treasury = 25
        add_country_modifier = {
            name = magic_bankrupt_recovery_mod
            duration = 182
        }

        set_variable = omni_studying_phase_three_var
        remove_variable = omni_studying_phase_two_var
    }

    option = {
        name = "me_magic_studying.7.b"
        add_political_influence = -25
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_three_var
    }
}

# Neglecting Rule
me_magic_studying.8 = {
    type = country_event

    title = me_magic_studying.8_title
    desc = me_magic_studying.8_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
        }
    }

    option = {
        name = "me_magic_studying.8.a"
        add_country_modifier = {
            name = magic_ruler_neglect_mod
            duration = 365
        }
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_three_var
    }
}

# CLASS

# Hierophant Success T2
me_magic_studying.9 = {
    type = country_event

    title = me_magic_studying.9_title
    desc = me_magic_studying.9_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
            has_variable = omni_studying_hierophant_var
            has_variable = hierophant_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.9.a"
        add_innovation = 1
        set_variable = omni_studying_phase_three_var
        remove_variable = omni_studying_phase_two_var
    }
}

# Hierophant Frustration T1
me_magic_studying.10 = {
    type = country_event

    title = me_magic_studying.10_title
    desc = me_magic_studying.10_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
            has_variable = omni_studying_hierophant_var
            NOT = {
                has_variable = hierophant_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.10.a"
        add_political_influence = -15
        magic_hierophant_frustration_mod
        add_country_modifier = {
            name = magic_hierophant_frustration_mod
            duration = 90
        }
    }
}

# Necromancer Pact T2
me_magic_studying.11 = {
    type = country_event

    title = me_magic_studying.11_title
    desc = me_magic_studying.11_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
            has_variable = omni_studying_necromancer_var
            has_variable = necromancer_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.11.a"
        current_ruler = {
            add_popularity = popularity_medium
            add_legitimacy = 8
        }
        add_stability = 12
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_phase_one_var
        remove_variable = omni_studying_necromancer_var
    }

    option = {
        name = "me_magic_studying.11.b"
        current_ruler = {
            add_martial = 1
            force_add_trait = melodian_pact_trait
        }
        add_stability = -8
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_one_var
    }
}

# Warlock Pact T1
me_magic_studying.12 = {
    type = country_event

    title = me_magic_studying.12_title
    desc = me_magic_studying.12_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_two_var
            has_variable = omni_studying_warlock_var
            NOT = {
                has_variable = warlock_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.12.a"
        current_ruler = {
            add_popularity = popularity_medium
            add_legitimacy = 8
        }
        add_stability = 12
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_phase_one_var
        remove_variable = omni_studying_warlock_var
    }

    option = {
        name = "me_magic_studying.12.b"
        current_ruler = {
            add_martial = 1
            force_add_trait = melodian_pact_trait
        }
        add_stability = -8
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_one_var
    }
}


# PHASE THREE

# BASIC

# Burnt Out
me_magic_studying.13 = {
    type = country_event

    title = me_magic_studying.13_title
    desc = me_magic_studying.13_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_three_var
        }
    }

    option = {
        name = "me_magic_studying.13.a"
        add_country_modifier = {
            name = magic_burnt_out_mod
            duration = 90
        }
        current_ruler = {
            force_add_trait = stressed
        }
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_three_var
    }
}

# Embezzlement
me_magic_studying.14 = {
    type = country_event

    title = me_magic_studying.14_title
    desc = me_magic_studying.14_desc
    picture = ascetic
    left_portrait = current_ruler


    immediate = {
        add_treasury = -100
    }

    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_three_var
        }
    }

    option = {
        name = "me_magic_studying.14.a"
        add_treasury = 150
        add_stability = -12
        add_country_modifier = {
            name = magic_embezzlement_mod
            duration = 182
        }

        set_variable = omni_studying_graduate_var
        remove_variable = omni_studying_phase_three_var
    }

    option = {
        name = "me_magic_studying.14.b"
        add_political_influence = -35
        add_treasury = 50
        add_stability = -2
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_three_var
    }
}

# Excelling at Studies
me_magic_studying.15 = {
    type = country_event

    title = me_magic_studying.15_title
    desc = me_magic_studying.15_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_three_var
        }
    }

    option = {
        name = "me_magic_studying.15.a"
        add_political_influence = 15
        set_variable = omni_studying_graduate_var
        remove_variable = omni_studying_phase_three_var
    }
}

# CLASS

# Diviner Accident T1
me_magic_studying.16 = {
    type = country_event

    title = me_magic_studying.16_title
    desc = me_magic_studying.16_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_three_var
            has_variable = omni_studying_diviner_var
            NOT = {
                has_variable = diviner_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.16.b"
        current_ruler = {
            force_add_trait = blind
        }
        add_stability = -3
    }
}

# Warlock Insanity T2
me_magic_studying.17 = {
    type = country_event

    title = me_magic_studying.17_title
    desc = me_magic_studying.17_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_phase_three_var
            has_variable = omni_studying_warlock_var
            NOT = {
                has_variable = warlock_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.17.b"
        current_ruler = {
            add_martial = 1
            force_add_trait = maniac
            force_add_trait = lunatic
        }
        add_stability = -8
        set_variable = omni_studying_phase_two_var
        remove_variable = omni_studying_phase_one_var
    }
}

# GRADUATION

# T1

# Diviner T1
me_magic_studying.18 = {
    type = country_event

    title = me_magic_studying.18_title
    desc = me_magic_studying.18_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_diviner_var
            NOT = {
                has_variable = diviner_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.18.a"
        current_ruler = {
            limit = { has_variable = first_time_mage_var }

            add_trait = mage_trait
        }


        set_variable = diviner_t2_unlocked_var
        remove_variable = omni_studying_diviner_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
        remove_variable = first_time_mage_var
    }
}

# Hierophant T1
me_magic_studying.19 = {
    type = country_event

    title = me_magic_studying.19_title
    desc = me_magic_studying.19_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_hierophant_var
            NOT = {
                has_variable = hierophant_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.19.a"
        current_ruler = {
            limit = { has_variable = first_time_mage_var }

            add_trait = mage_trait
        }


        set_variable = hierophant_t2_unlocked_var
        remove_variable = omni_studying_hierophant_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
        remove_variable = first_time_mage_var
    }
}

# Necromancer T1
me_magic_studying.20 = {
    type = country_event

    title = me_magic_studying.20_title
    desc = me_magic_studying.20_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_necromancer_var
            NOT = {
                has_variable = necromancer_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.20.a"
        current_ruler = {
            limit = { has_variable = first_time_mage_var }

            add_trait = mage_trait
        }


        set_variable = necromancer_t2_unlocked_var
        remove_variable = omni_studying_necromancer_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
        remove_variable = first_time_mage_var
    }
}

# Warlock T1
me_magic_studying.21 = {
    type = country_event

    title = me_magic_studying.21_title
    desc = me_magic_studying.21_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_warlock_var
            NOT = {
                has_variable = warlock_t2_unlocked_var
            }
        }
    }

    option = {
        name = "me_magic_studying.20.a"
        current_ruler = {
            limit = { has_variable = first_time_mage_var }

            add_trait = mage_trait
        }


        set_variable = warlock_t2_unlocked_var
        remove_variable = omni_studying_warlock_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
        remove_variable = first_time_mage_var
    }
}


# T2

# Diviner T2
me_magic_studying.22 = {
    type = country_event

    title = me_magic_studying.22_title
    desc = me_magic_studying.22_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_diviner_var
            has_variable = diviner_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.22.a"
        current_ruler = {
            remove_trait = mage_trait
            remove_trait = hierophant_trait
            remove_trait = druid_trait
            remove_trait = elementalist_trait
            remove_trait = cleric_trait
            remove_trait = illusionist_trait
            remove_trait = warlock_trait
            remove_trait = necromancer_trait
            add_trait = diviner_trait
        }

        set_variable = diviner_t3_unlocked_var
        remove_variable = omni_studying_diviner_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
    }
}

# Hierophant T2
me_magic_studying.23 = {
    type = country_event

    title = me_magic_studying.23_title
    desc = me_magic_studying.23_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_hierophant_var
            has_variable = hierophant_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.23.a"
        current_ruler = {
            remove_trait = mage_trait
            remove_trait = diviner_trait
            remove_trait = druid_trait
            remove_trait = elementalist_trait
            remove_trait = cleric_trait
            remove_trait = illusionist_trait
            remove_trait = warlock_trait
            remove_trait = necromancer_trait
            add_trait = hierophant_trait
        }

        set_variable = hierophant_t3_unlocked_var
        remove_variable = omni_studying_hierophant_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
    }
}

# Necromancer T2
me_magic_studying.24 = {
    type = country_event

    title = me_magic_studying.24_title
    desc = me_magic_studying.24_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_necromancer_var
            has_variable = necromancer_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.24.a"
        current_ruler = {
            remove_trait = mage_trait
            remove_trait = hierophant_trait
            remove_trait = druid_trait
            remove_trait = elementalist_trait
            remove_trait = cleric_trait
            remove_trait = illusionist_trait
            remove_trait = warlock_trait
            remove_trait = diviner_trait
            add_trait = necromancer_trait
        }

        set_variable = necromancer_t3_unlocked_var
        remove_variable = omni_studying_necromancer_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
    }
}



# Warlock T2
me_magic_studying.25 = {
    type = country_event

    title = me_magic_studying.25_title
    desc = me_magic_studying.25_desc
    picture = ascetic
    left_portrait = current_ruler


    trigger = {
        AND = {
            has_variable = omni_studying_magic_cooldown
            has_variable = omni_studying_graduate_var
            has_variable = omni_studying_warlock_var
            has_variable = warlock_t2_unlocked_var
        }
    }

    option = {
        name = "me_magic_studying.25.a"
        current_ruler = {
            remove_trait = mage_trait
            remove_trait = hierophant_trait
            remove_trait = druid_trait
            remove_trait = elementalist_trait
            remove_trait = cleric_trait
            remove_trait = illusionist_trait
            remove_trait = diviner_trait
            remove_trait = necromancer_trait
            add_trait = warlock_trait
        }

        set_variable = warlock_t3_unlocked_var
        remove_variable = omni_studying_warlock_var
        remove_variable = omni_studying_magic_cooldown
        remove_variable = omni_studying_graduate_var
    }
}



